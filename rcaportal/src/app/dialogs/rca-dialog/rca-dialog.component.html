

<div class="dialog-header">{{dialogTitle}}</div>
<div class="load-parent">
<mat-dialog-content class="dialog-content">
  <mat-form-field class="one-line-item full-width" >
    <mat-label><span class="input-label">Header</span></mat-label>
    <textarea  matInput name="Head" [(ngModel)]="rcaData.Header" required></textarea>
  </mat-form-field>

  <mat-form-field>
    <mat-label><span class="input-label">ID</span><mat-icon>bug_report</mat-icon></mat-label>
    <input matInput name="Id" [(ngModel)]="rcaData.RCAID" required>
  </mat-form-field>

  <mat-form-field>
    <mat-label><span class="input-label">RootCauseCR </span><mat-icon>bug_report</mat-icon></mat-label>
    <input matInput name="RootCauseCR" [(ngModel)]="rcaData.RootCauseCR">
  </mat-form-field >

  <mat-form-field class="one-line-item">
    <mat-label><span class="input-label">Submitter</span></mat-label>
    <input matInput name="Submitter" [(ngModel)]="rcaData.Submitter" required>
  </mat-form-field>

  <mat-form-field class="one-line-item">
    <mat-label><span class="input-label">Impacted Product</span></mat-label>
    <mat-select name="ImpactedProduct" [(value)]="selectedProductID" required>
      <mat-option *ngFor="let impactedProduct of impactedProducts" [value]="impactedProduct.ID">{{impactedProduct.ProductName}}</mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field class="one-line-item">
    <mat-label><span class="input-label">Fix Version</span></mat-label>
    <mat-select name="FixVersion" [disabled]="!isFixVersionListReady" [(value)]="rcaData.FixVersionID" required>
      <mat-option *ngFor="let fixVersion of fixVersionList" [value]="fixVersion.ID">{{fixVersion.Version}}</mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field class="one-line-item">
    <mat-label><span class="input-label">Component </span><mat-icon>extension</mat-icon></mat-label>
    <mat-select name="Component" [disabled]="!isComponentListReady" [(value)]="rcaData.ComponentID" required>
      <mat-option *ngFor="let component of componentList" [value]="component.ID">{{component.ComponentName}}</mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field class="one-line-item">
    <mat-label><span class="input-label">Readout Level</span></mat-label>
    <mat-select name="ReadoutLevel" [(value)]="rcaData.ReadoutLevelID" required>
      <mat-option *ngFor="let readoutLevel of readoutLevels" [value]="readoutLevel.ID">{{readoutLevel.ReadoutLevel}}</mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field class="one-line-item full-width">
    <mat-label class="input-label"><span>Key Word</span><mat-icon>vpn_key</mat-icon></mat-label>
    <mat-chip-list #chipList aria-label="Key Word">
      <mat-chip
        *ngFor="let keyWord of rcaData.KeyWords"
        [selectable]="selectable"
        [removable]="removable"
        (removed)="remove(keyWord)">
        {{keyWord}}
        <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
      </mat-chip>
      <input
        placeholder="New Keyword..."
        #keyWordInput
        [formControl]="keyWordCtrl"
        [matAutocomplete]="auto"
        [matChipInputFor]="chipList"
        [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
        [matChipInputAddOnBlur]="addOnBlur"
        (matChipInputTokenEnd)="add($event)">
    </mat-chip-list>
    <mat-autocomplete #auto="matAutocomplete" (optionSelected)="selected($event)">
      <mat-option *ngFor="let keyWord of filteredKeyWords | async" [value]="keyWord">
        {{keyWord}}
      </mat-option>
    </mat-autocomplete>
    <mat-hint class="mat-hit-keyword">
      <span class="keyWord-tip" *ngFor="let keyWordTip of keyWordTips" (click)="OnClickKeyWordTip(keyWordTip)">{{keyWordTip}}</span>
    </mat-hint>
  </mat-form-field>

  <div class="one-line-item full-width" style="margin: 6px 0 0 0;">
    <label ><span class="input-label">Root Cause Analyze</span></label>
    <quill-editor [(ngModel)]="rcaData.RootCauseAnalyze" [styles]="{height: '100px'}" >
    </quill-editor>
  </div>

  <div class="one-line-item full-width">
    <div class="expand-div"
    (click)="isRequirementPanelOpen=!isRequirementPanelOpen">
    <span class="requirement-color">Requirement</span>
    <i class="material-icons" *ngIf="!isRequirementPanelOpen">keyboard_arrow_down</i>
    <i class="material-icons" *ngIf="isRequirementPanelOpen">keyboard_arrow_up</i>
    </div>
    <div class="expand-panel full-width" *ngIf="isRequirementPanelOpen">
      <label class="requirement-color label-margin">Root Cause</label>
      <quill-editor [(ngModel)]="rcaData.RequirementCorrectAndPrevention.RootCause" [styles]="{height: '100px'}">
      </quill-editor>
      <label class="requirement-color label-margin">Correction</label>
      <quill-editor [(ngModel)]="rcaData.RequirementCorrectAndPrevention.Correction" [styles]="{height: '100px'}">
      </quill-editor>
      <label class="requirement-color label-margin">Prevention</label>
      <quill-editor [(ngModel)]="rcaData.RequirementCorrectAndPrevention.Prevention" [styles]="{height: '100px'}">
      </quill-editor>
    </div>
  </div>

  <div class="one-line-item full-width">
    <div class="expand-div"
    (click)="isDevPanelOpen=!isDevPanelOpen">
    <span class="dev-color">Dev(Dev/InforDev/CM)</span>
    <i class="material-icons" *ngIf="!isDevPanelOpen">keyboard_arrow_down</i>
    <i class="material-icons" *ngIf="isDevPanelOpen">keyboard_arrow_up</i>
    </div>
    <div class="full-width expand-panel" *ngIf="isDevPanelOpen">
      <label class="dev-color label-margin">Root Cause</label>
      <quill-editor [(ngModel)]="rcaData.DevCorrectAndPrevention.RootCause" [styles]="{height: '100px'}">
      </quill-editor>
      <label class="dev-color label-margin">Correction</label>
      <quill-editor [(ngModel)]="rcaData.DevCorrectAndPrevention.Correction" [styles]="{height: '100px'}">
      </quill-editor>
      <label class="dev-color label-margin">Prevention</label>
      <quill-editor [(ngModel)]="rcaData.DevCorrectAndPrevention.Prevention" [styles]="{height: '100px'}">
      </quill-editor>
    </div>
  </div>

  <div class="one-line-item full-width">
    <div class="expand-div"
    (click)="isTestPanelOpen=!isTestPanelOpen">
    <span class="test-color">Test</span>
    <i class="material-icons" *ngIf="!isTestPanelOpen">keyboard_arrow_down</i>
    <i class="material-icons" *ngIf="isTestPanelOpen">keyboard_arrow_up</i>
    </div>
    <div class="full-width expand-panel" *ngIf="isTestPanelOpen">
      <label class="test-color label-margin">Root Cause</label>
      <quill-editor [(ngModel)]="rcaData.TestCorrectAndPrevention.RootCause" [styles]="{height: '100px'}">
      </quill-editor>
      <label class="test-color label-margin">Correction</label>
      <quill-editor [(ngModel)]="rcaData.TestCorrectAndPrevention.Correction" [styles]="{height: '100px'}">
      </quill-editor>
      <label class="test-color label-margin">Prevention</label>
      <quill-editor [(ngModel)]="rcaData.TestCorrectAndPrevention.Prevention" [styles]="{height: '100px'}">
      </quill-editor>
    </div>
  </div>

  <div *ngIf="!isCreateMode" class="one-line-item full-width">
    <div class="attachment-icon" >
      <span>Attachment</span><mat-icon>attachment</mat-icon>
    </div>
    <app-attachment [RCAID]="data.rcaID" [IsReadOnly]="false" (Loaded)=AttachmentLoaded()></app-attachment>
  </div>
  <div class="first-loading" *ngIf="isFirstLoading">
    Loading...
  </div>

</mat-dialog-content>
</div>


<div mat-dialog-actions class="dialog-actions">
  <div>
    <button mat-button (click)="onCancelClick()">Cancel</button>
    <button mat-button (click)="onCreateClick()" [ngClass]="{'disable-btn': !isAllowCreate}"   *ngIf="isCreateMode" [disabled]="!isAllowCreate" >Create</button>
    <button mat-button (click)="onUpdateClick()" [ngClass]="{'disable-btn': !isAllowUpdate}"  *ngIf="!isCreateMode" [disabled]="!isAllowUpdate">Update</button>
  </div>
</div>

